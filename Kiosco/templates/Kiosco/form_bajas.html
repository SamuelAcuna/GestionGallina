{% extends 'Kiosco/base_kiosco.html' %}

{% block content %}
<h3 class="text-center mb-4">Registrar Bajas - {{ lote.galpon.nombre }}</h3>

<div class="row justify-content-center">
    <div class="col-md-6">
        <div class="card p-4 shadow-sm border-0 border-danger"
            style="border-radius: 15px; border-left: 5px solid #dc3545;">
            <div class="text-center mb-4">
                <i class="bi bi-heart-pulse-fill text-danger" style="font-size: 4rem;"></i>
            </div>

            <form method="post">
                {% csrf_token %}

                <div class="mb-4">
                    <label class="form-label h5">Motivo</label>
                    <select name="motivo" class="form-select form-select-lg" required>
                        <option value="NATURAL">Muerte Natural</option>
                        <option value="SACRIFICIO">Sacrificio</option>
                        <option value="ENFERMEDAD">Enfermedad</option>
                        <option value="OTRO">Otro</option>
                    </select>
                </div>

                <div class="mb-4">
                    <label class="form-label h5">Cantidad</label>
                    <input type="number" step="1" name="cantidad" class="form-control form-control-lg" placeholder="1"
                        required>
                </div>

                <button type="submit" class="btn btn-danger btn-lg w-100 py-3 fw-bold">
                    <i class="bi bi-exclamation-triangle-fill"></i> REGISTRAR BAJA
                </button>
            </form>
        </div>
    </div>
</div>

</div>

<!-- Daily Log -->
<div class="row justify-content-center mt-5">
    <div class="col-md-8">
        <h5 class="text-center mb-3">Registros de Hoy</h5>
        <div class="table-responsive">
            <table class="table table-bordered table-striped text-center">
                <thead class="table-light">
                    <tr>
                        <th>Hora</th>
                        <th>Motivo</th>
                        <th>Cant.</th>
                        <th>Acci√≥n</th>
                    </tr>
                </thead>
                <tbody>
                    {% for m in movimientos %}
                    <tr>
                        <td>{{ m.fecha|date:"H:i" }}</td>
                        <td>{{ m.get_motivo_display }}</td>
                        <td>{{ m.cantidad }}</td>
                        <td>
                            <a href="{% url 'kiosco-bajas-edit' m.pk %}" class="btn btn-sm btn-outline-primary">
                                <i class="bi bi-pencil"></i>
                            </a>
                        </td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="4" class="text-muted">Sin registros hoy</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>

<div class="text-center mt-4">
    <a href="{% url 'kiosco-menu' lote.pk %}" class="btn btn-outline-secondary btn-lg px-5">
        <i class="bi bi-x-lg"></i> Cancelar
    </a>
</div>
{% endblock %}